# =============================================================================
# Step 2: Activations
# =============================================================================
#
# Define activation destinations for each stage's outbound actions.
#
# --- Discovery Workflow ---
# Run these commands to find connections and their config fields:
#
#   tdx connection list                       # List available connections
#   tdx connection types                      # List all connector types
#   tdx connection schema "My SFMC Connection" # Get connector_config fields
#
# See connector-config skill for connector-specific fields.
#
# --- Schedule Strategy ---
# Ask the client which timing to use:
#
#   run_after_journey_refresh: true   — run after parent segment refresh (most common)
#   schedule:                         — fixed schedule
#     type: daily | none
#     timezone: America/Los_Angeles
#
# --- Activation Structure ---
#   activations:
#     activation-key:                     # key — referenced in step's with.activation
#       name: Display Name                # display name
#       connection: Connection Name       # from tdx connection list
#       all_columns: true
#       run_after_journey_refresh: true    # or use schedule: { type: daily, ... }
#       connector_config:                  # from tdx connection schema
#         field_name: value
#
# --- After updating the YAML ---
#   1. Add activations: section organized by stage with comments
#   2. Write the updated YAML to the journey file
#   3. Interactive mode: Show the result and STOP. Do NOT ask "proceed?" — just wait.
#      Auto mode: Proceed directly to Step 3
#
# =============================================================================

type: journey
name: Welcome Onboarding Journey
description: 3-stage onboarding flow for new customers
reentry: no_reentry

segments:
  # (segments from Step 1, omitted for brevity)

# Activation definitions — referenced by key in steps (Step 3)
activations:
  # -- Stage 1: Welcome & Engagement --
  welcome-email:
    name: Welcome Email Campaign
    connection: My SFMC Connection         # from `tdx connection list`
    all_columns: true
    run_after_journey_refresh: true         # run after parent segment refresh
    connector_config:                       # from `tdx connection schema "My SFMC Connection"`
      de_name: WelcomeEmails
      shared_data_extension: false
      data_operation: upsert

  sms-reminder:
    name: SMS Reminder
    connection: Twilio SMS Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      message_template: welcome_reminder

  # -- Stage 2: Product Activation --
  upsell-email:
    name: Upsell Offer Email
    connection: My SFMC Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      de_name: UpsellOffers
      shared_data_extension: false
      data_operation: upsert

  feature-tips-email:
    name: Feature Tips Email
    connection: My SFMC Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      de_name: FeatureTips
      shared_data_extension: false
      data_operation: upsert

  reengage-push:
    name: Re-engagement Push Notification
    connection: Braze Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      campaign_id: reengage_001

  # -- Stage 3: Retention & Loyalty --
  nps-survey-email:
    name: NPS Survey Email
    connection: My SFMC Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      de_name: NPSSurvey
      shared_data_extension: false
      data_operation: upsert

  referral-invite-email:
    name: Referral Invite Email
    connection: My SFMC Connection
    all_columns: true
    run_after_journey_refresh: true
    connector_config:
      de_name: ReferralInvites
      shared_data_extension: false
      data_operation: upsert

  # Example: fixed schedule instead of run_after_journey_refresh
  # weekly-digest:
  #   name: Weekly Digest
  #   connection: My SFMC Connection
  #   all_columns: true
  #   schedule:
  #     type: daily
  #     timezone: America/Los_Angeles
  #   connector_config:
  #     de_name: WeeklyDigest
  #     data_operation: upsert
