# semantic/data_dictionary.yaml
# Data Dictionary for Golden Layer Tables
# Defines descriptions, tags, business terms, and metadata for all fields

version: "1.0"
last_synced: "2026-02-15T00:00:00Z"

# ============================================================================
# TABLES SECTION
# ============================================================================
tables:

  # ──────────────────────────────────────────────────────────────────────────
  # EXAMPLE 1: Customer Dimension Table
  # ──────────────────────────────────────────────────────────────────────────
  analytics.dim_customers:
    # Table-level metadata
    description: |
      Master customer dimension table containing attributes and ML-computed features.
      One row per customer with historical context and behavioral attributes.
      Updated daily via dbt model from staging layer.

    owner: analytics-team
    steward_email: analytics@company.com
    refresh_cadence: daily
    created_date: "2024-01-15"

    # Fields in this table
    fields:

      - name: customer_id
        type: string
        description: "Unique identifier for each customer across all systems. Primary key."
        tags: [ID, primary_key, business_critical]
        is_pii: false
        business_term: Customer Identifier
        owner: analytics-team
        data_classification: internal

      - name: email
        type: string
        description: |
          Customer email address used for communications, marketing, and account recovery.
          Deduplicated and lowercased. May be null for legacy accounts.
        tags: [contact_info, pii, email]
        is_pii: true
        pii_category: email
        owner: compliance-team
        steward_email: compliance@company.com
        data_classification: restricted

      - name: phone
        type: string
        description: "Customer phone number (E.164 format). Used for SMS and support communications."
        tags: [contact_info, pii]
        is_pii: true
        pii_category: phone
        owner: compliance-team
        data_classification: restricted

      - name: first_name
        type: string
        description: "Customer's first name. Trimmed and in mixed case."
        tags: [pii, personal_data]
        is_pii: true
        pii_category: name
        owner: compliance-team

      - name: last_name
        type: string
        description: "Customer's last name. Trimmed and in mixed case."
        tags: [pii, personal_data]
        is_pii: true
        pii_category: name
        owner: compliance-team

      - name: signup_date
        type: timestamp
        description: "Date and time when customer first registered in the system. Immutable."
        tags: [timestamp, audit_trail]
        is_pii: false

      - name: last_login_date
        type: timestamp
        description: "Timestamp of customer's most recent login. Updated in real-time."
        tags: [timestamp, behavioral]
        is_pii: false

      - name: predicted_clv
        type: double
        description: |
          12-month CLV prediction from ML model v2.3.
          Ensemble of gradient boosting and neural network.
          Trained on 24 months of historical behavior.
          Updated monthly on the 1st at UTC 00:00.
          Range: 0.0 to 100000.0 (in USD).
        tags: [metric, ml_output, business_critical, forecast]
        is_pii: false
        business_term: Customer Lifetime Value
        business_rule: "Customers with CLV > $10,000 are eligible for premium support tier"
        owner: data-science-team
        steward_email: mlops@company.com
        data_classification: internal
        sla_refresh_frequency: monthly
        sla_max_staleness_hours: 744  # 31 days

      - name: churn_risk_score
        type: double
        description: |
          Probability (0-100) that customer will not purchase in next 90 days.
          Calculated weekly using logistic regression model.
          Influenced by: last purchase date, purchase frequency, seasonal patterns.
        tags: [metric, ml_output, risk_score]
        is_pii: false
        business_term: Churn Risk
        owner: data-science-team
        data_classification: internal
        sla_refresh_frequency: weekly

      - name: total_lifetime_purchases
        type: bigint
        description: "Cumulative count of all purchases made by customer. Updated real-time."
        tags: [metric, behavioral]
        is_pii: false
        data_classification: internal

      - name: total_lifetime_revenue
        type: double
        description: "Sum of all revenues generated by customer (USD). Excludes refunds and discounts."
        tags: [metric, financial]
        is_pii: false
        data_classification: internal

      - name: customer_segment
        type: string
        description: |
          Segment classification based on RFM analysis.
          Values: premium, active, at_risk, inactive, new.
        tags: [dimension, classification]
        is_pii: false
        business_term: Customer Segment
        valid_values: [premium, active, at_risk, inactive, new]

      - name: created_at
        type: timestamp
        description: "Timestamp when this record was created in the data warehouse."
        tags: [timestamp, metadata]
        is_pii: false

      - name: updated_at
        type: timestamp
        description: "Timestamp when this record was last updated."
        tags: [timestamp, metadata]
        is_pii: false

  # ──────────────────────────────────────────────────────────────────────────
  # EXAMPLE 2: Orders Fact Table
  # ──────────────────────────────────────────────────────────────────────────
  analytics.fact_orders:
    description: "Transactional order fact table. One row per order with financial metrics."
    owner: revenue-team
    steward_email: revenue@company.com
    refresh_cadence: hourly

    fields:

      - name: order_id
        type: string
        description: "Unique order identifier. Primary key. Immutable."
        tags: [ID, primary_key, business_critical]
        is_pii: false
        business_term: Order Identifier

      - name: customer_id
        type: string
        description: "Foreign key to dim_customers. Links order to customer."
        tags: [ID, foreign_key]
        is_pii: false
        business_term: Customer Identifier

      - name: order_date
        type: timestamp
        description: "Date and time when order was placed by customer."
        tags: [timestamp, business_date]
        is_pii: false

      - name: order_amount
        type: double
        description: "Total order amount in USD. Includes tax and shipping. Excludes discounts."
        tags: [metric, financial, amount]
        is_pii: false
        data_classification: internal

      - name: tax_amount
        type: double
        description: "Sales tax amount charged for this order (USD)."
        tags: [metric, financial]
        is_pii: false

      - name: shipping_amount
        type: double
        description: "Shipping cost for this order (USD)."
        tags: [metric, financial]
        is_pii: false

      - name: discount_amount
        type: double
        description: "Total discount applied to order (USD). May include coupons and promotions."
        tags: [metric, financial]
        is_pii: false

      - name: order_status
        type: string
        description: |
          Current status of order.
          Values: pending, confirmed, shipped, delivered, cancelled, refunded.
        tags: [dimension, status]
        is_pii: false
        valid_values: [pending, confirmed, shipped, delivered, cancelled, refunded]

      - name: payment_method
        type: string
        description: "Payment method used. Values: credit_card, debit_card, paypal, bank_transfer."
        tags: [dimension, payment]
        is_pii: false
        valid_values: [credit_card, debit_card, paypal, bank_transfer]

      - name: order_item_count
        type: int
        description: "Number of distinct items in this order."
        tags: [metric]
        is_pii: false

      - name: created_at
        type: timestamp
        description: "Timestamp when record was created in warehouse."
        tags: [timestamp, metadata]
        is_pii: false

      - name: updated_at
        type: timestamp
        description: "Timestamp when record was last updated."
        tags: [timestamp, metadata]
        is_pii: false



  # ──────────────────────────────────────────────────────────────────────────
  # LOYALTY PROFILE TABLE (for auto-generation testing)
  # ──────────────────────────────────────────────────────────────────────────
  gld_cstore_prod.loyalty_profile:
    # Table-level metadata
    description: |
      Customer loyalty program profile with points balance, membership tier, and historical tracking.
      One row per customer in the loyalty program.
      Updated real-time with transaction activity.

    owner: loyalty-team
    steward_email: loyalty@company.com
    refresh_cadence: real-time
    created_date: "2024-06-01"

    # Fields in this table (auto-generated descriptions)
    fields:

      - name: customer_id
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: td_id
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: email
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: secondary_email
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: phone_number
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: first_name
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: last_name
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: address
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: country
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: city
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: state
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: postal_code
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: gender
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: date_of_birth
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false
        pii_category: null

      - name: date_of_birth_unix
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: membership_status
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: membership_tier
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: net_redeemable_balance
        type: double
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: net_debits
        type: double
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: membership_points_earned
        type: double
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: membership_points_balance
        type: double
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: membership_points_pending
        type: double
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: total_loyalty_purchases
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: current_membership_level_expiration
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: current_membership_level_expiration_unix
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: created_at
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: created_at_unix
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: updated_at
        type: string
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: updated_at_unix
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

      - name: time
        type: bigint
        description: ""  # Will be auto-generated
        tags: []
        is_pii: false

# ============================================================================
glossary:

  - term: Customer Lifetime Value
    abbreviation: CLV
    definition: |
      Total predicted revenue from a customer over their entire relationship
      with the company. Calculated as a 12-month forward-looking projection.
    owner: analytics-team
    related_fields:
      - analytics.dim_customers.predicted_clv
      - analytics.dim_customers.total_lifetime_revenue
    business_rule: |
      Customers with CLV > $10,000 are eligible for premium support tier.
      Used for customer acquisition cost (CAC) payback analysis.
    last_reviewed_at: "2026-01-30"

  - term: Customer Identifier
    abbreviation: CID
    definition: |
      Unique identifier assigned to each customer for cross-system reconciliation.
      Maintained in master customer table and used as foreign key in all related tables.
    owner: data-governance
    related_fields:
      - analytics.dim_customers.customer_id
      - analytics.fact_orders.customer_id
    last_reviewed_at: "2026-02-01"

  - term: Churn Risk
    abbreviation: null
    definition: |
      Probability (0-100) that a customer will not make a purchase within
      the next 90 days. Used to identify at-risk customers for retention campaigns.
    owner: data-science-team
    related_fields:
      - analytics.dim_customers.churn_risk_score
    business_rule: |
      Customers with churn_risk_score > 70 are flagged for immediate outreach.
    last_reviewed_at: "2026-02-10"

  - term: Customer Segment
    abbreviation: null
    definition: |
      Behavioral segmentation based on Recency, Frequency, Monetary (RFM) analysis.
      Categories: Premium (high value), Active (regular purchases),
      At-Risk (declining engagement), Inactive (no recent purchases), New (<30 days).
    owner: analytics-team
    related_fields:
      - analytics.dim_customers.customer_segment
    business_rule: |
      Segment is updated weekly after RFM calculation runs.
      Used to determine email campaign cadence and offer targeting.
    last_reviewed_at: "2026-02-08"

  - term: Order Identifier
    abbreviation: null
    definition: |
      Unique identifier for each customer transaction.
      Used to link order details, items, payments, and shipment information.
    owner: revenue-team
    related_fields:
      - analytics.fact_orders.order_id
    last_reviewed_at: "2026-02-05"
